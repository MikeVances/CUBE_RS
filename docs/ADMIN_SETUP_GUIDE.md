# üîß –†–£–ö–û–í–û–î–°–¢–í–û –ü–û –ê–î–ú–ò–ù–ò–°–¢–†–ò–†–û–í–ê–ù–ò–Æ CUBE_RS

## üéØ –û–¢–í–ï–¢ –ù–ê –ì–õ–ê–í–ù–´–ô –í–û–ü–†–û–°

> **"–ö–∞–∫ —É–ø—Ä–∞–≤–ª—è—Ç—å, –¥–æ–±–∞–≤–ª—è—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Ä–∞–∑–¥–∞–≤–∞—Ç—å –∏–º –∫–ª—é—á–∏ –∏ –ø–æ–¥–∫–ª—é—á–∞—Ç—å –∫ –∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º?"**

### ‚úÖ **–†–ï–®–ï–ù–ò–ï –ì–û–¢–û–í–û!** 

–°–æ–∑–¥–∞–Ω–∞ **CLI —É—Ç–∏–ª–∏—Ç–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è** –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–æ–π.

---

## üöÄ –ë–´–°–¢–†–´–ô –°–¢–ê–†–¢

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å–∏—Å—Ç–µ–º—ã
```bash
python tools/admin_cli.py status
```

### 2. –°–æ–∑–¥–∞–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
```bash
python tools/admin_cli.py create-user \
  --username admin \
  --email admin@company.com \
  --full-name "System Administrator" \
  --password secure123 \
  --role "System Administrator" \
  --admin
```

### 3. –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```bash  
python tools/admin_cli.py create-user \
  --username farmer1 \
  --email farmer1@company.com \
  --full-name "–§–µ—Ä–º–µ—Ä –ò–≤–∞–Ω–æ–≤" \
  --password farm123 \
  --role "Farm Operator"
```

### 4. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞ –¥–ª—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
```bash
python tools/admin_cli.py create-device-key \
  --expires 24 \
  --tags farm production \
  --created-by admin
```

### 5. –ü—Ä–æ—Å–º–æ—Ç—Ä –æ–∂–∏–¥–∞—é—â–∏—Ö —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–π
```bash
python tools/admin_cli.py list-pending
```

### 6. –û–¥–æ–±—Ä–µ–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
```bash
python tools/admin_cli.py approve-registration \
  --request-id <REQUEST_ID> \
  --approved-by admin
```

---

## üìã –ü–û–õ–ù–´–ô –ü–†–û–¶–ï–°–° –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–Ø –£–°–¢–†–û–ô–°–¢–í–ê

### –®–∞–≥ 1: –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —Å–æ–∑–¥–∞–µ—Ç –∫–ª—é—á
```bash
python tools/admin_cli.py create-device-key --expires 24 --tags farm
# –†–µ–∑—É–ª—å—Ç–∞—Ç: tskey-xxxxxxxxxxxxxxxxxxx
```

### –®–∞–≥ 2: –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è (–ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ)
–ù–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ –ö–£–ë-1063 –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è:
```python
from web_app.device_registry import get_device_registry

registry = get_device_registry()
request_id = registry.create_registration_request(
    auth_key="tskey-xxxxxxxxxxxxxxxxxxx",
    device_hostname="kub-farm-001", 
    device_type="farm",
    device_info={
        "os": "Linux",
        "location": "–¢–µ–ø–ª–∏—Ü–∞ ‚Ññ1",
        "capabilities": ["kub1063", "monitoring"]
    },
    tailscale_ip="100.64.1.10"
)
```

### –®–∞–≥ 3: –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –æ–¥–æ–±—Ä—è–µ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é
```bash
python tools/admin_cli.py list-pending
python tools/admin_cli.py approve-registration --request-id <ID>
```

### –®–∞–≥ 4: –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø–æ–ª—É—á–∞–µ—Ç –¥–æ—Å—Ç—É–ø ‚úÖ
–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º —Å–µ—Ä–≤–∏—Å–∞–º —Å–∏—Å—Ç–µ–º—ã.

---

## üîß –î–û–°–¢–£–ü–ù–´–ï –ö–û–ú–ê–ù–î–´ CLI

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
python tools/admin_cli.py create-user \
  --username <username> \
  --email <email> \
  --full-name "<Full Name>" \
  --password <password> \
  --role "<Role Name>" \
  [--admin]

# –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
python tools/admin_cli.py list-users
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª—é—á–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
python tools/admin_cli.py create-device-key \
  [--expires <hours>] \
  [--max-usage <count>] \
  [--tags <tag1> <tag2>] \
  [--created-by <username>]

# –°–ø–∏—Å–æ–∫ –æ–∂–∏–¥–∞—é—â–∏—Ö —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–π
python tools/admin_cli.py list-pending

# –û–¥–æ–±—Ä–µ–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
python tools/admin_cli.py approve-registration \
  --request-id <request_id> \
  [--approved-by <username>]

# –°–ø–∏—Å–æ–∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
python tools/admin_cli.py list-devices \
  [--type <device_type>] \
  [--status <status>]
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º—ã
```bash
# –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã
python tools/admin_cli.py status
```

---

## üë• –†–û–õ–ò –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ï–ô

–í —Å–∏—Å—Ç–µ–º–µ –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ —Ä–æ–ª–∏:

### **System Administrator**
- –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º —Ñ—É–Ω–∫—Ü–∏—è–º
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ —Ä–æ–ª—è–º–∏
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- –°–∏—Å—Ç–µ–º–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### **Farm Administrator** 
- –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é —Ñ–µ—Ä–º–æ–π
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º (VPN, VNC, SSH, HTTP)
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤

### **Farm Operator**
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –±–∞–∑–æ–≤–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ VNC –∏ HTTP
- API –¥–æ—Å—Ç—É–ø –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–æ—Å–º–æ—Ç—Ä —É—Å—Ç—Ä–æ–π—Å—Ç–≤

### **Service Engineer**
- –î–æ—Å—Ç—É–ø –¥–ª—è –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
- SSH –¥–æ—Å—Ç—É–ø –∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —Ä–µ–º–æ–Ω—Ç–∞
- VPN –∏ VNC –¥–æ—Å—Ç—É–ø

### **Read Only**
- –¢–æ–ª—å–∫–æ –ø—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö
- API –¥–æ—Å—Ç—É–ø –¥–ª—è —á—Ç–µ–Ω–∏—è
- –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç—É—Å–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤

---

## üîê –£–ü–†–ê–í–õ–ï–ù–ò–ï –î–û–°–¢–£–ü–û–ú

### –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä—É–ø–ø —É—Å—Ç—Ä–æ–π—Å—Ç–≤ (–ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ)
```python
from web_app.rbac_system import get_rbac_system

rbac = get_rbac_system()
group_id = rbac.create_device_group(
    name="Production Farms",
    description="–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ç–µ–ø–ª–∏—Ü—ã",
    device_types=["farm"],
    tags_filter=["production"]
)
```

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
```python
policy_id = rbac.create_access_policy(
    name="Farm Operator Access",
    description="–î–æ—Å—Ç—É–ø –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –∫ —Ñ–µ—Ä–º–∞–º",
    device_group_id=group_id,
    role_id=operator_role.role_id,
    permissions=[
        "device:view",
        "device:connect", 
        "service:vnc"
    ]
)
```

---

## üåê –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø –° –í–ï–ë-–ò–ù–¢–ï–†–§–ï–ô–°–û–ú

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ–Ω–∏ –º–æ–≥—É—Ç –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É —á–µ—Ä–µ–∑:
- **Web Dashboard**: http://localhost:5000
- **Tailscale Dashboard**: http://localhost:5000/tailscale
- **Mobile App**: –ü–æ Tailscale mesh-—Å–µ—Ç–∏

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)
–¢–µ–∫—É—â–∞—è —Å–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —É–ø—Ä–æ—â–µ–Ω–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é —á–µ—Ä–µ–∑ session. 
–î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–Ω—É—é —Å–∏—Å—Ç–µ–º—É login/logout.

---

## üìä –ü–†–ò–ú–ï–†–´ –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ù–æ–≤–∞—è —Ñ–µ—Ä–º–∞
```bash
# 1. –°–æ–∑–¥–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è-–æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ —Ñ–µ—Ä–º—ã
python tools/admin_cli.py create-user \
  --username farm_operator_1 \
  --email operator1@farm.com \
  --full-name "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á" \
  --password farm2024 \
  --role "Farm Operator"

# 2. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∫–ª—é—á –¥–ª—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ñ–µ—Ä–º—ã
python tools/admin_cli.py create-device-key \
  --expires 48 \
  --tags farm production greenhouse1 \
  --created-by farm_operator_1

# –†–µ–∑—É–ª—å—Ç–∞—Ç: tskey-abc123...
# –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–ª—é—á –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —Ñ–µ—Ä–º—ã

# 3. –ñ–¥–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∏ –æ–¥–æ–±—Ä—è–µ–º
python tools/admin_cli.py list-pending
python tools/admin_cli.py approve-registration --request-id xyz789

# 4. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å
python tools/admin_cli.py list-devices --type farm --status active
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –°–µ—Ä–≤–∏—Å–Ω–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ
```bash
# 1. –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∏–Ω–∂–µ–Ω–µ—Ä–∞
python tools/admin_cli.py create-user \
  --username service_tech \
  --email tech@service.com \
  --full-name "–¢–µ—Ö–Ω–∏–∫ –ü–µ—Ç—Ä–æ–≤" \
  --password service123 \
  --role "Service Engineer"

# 2. –°–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–π –∫–ª—é—á –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
python tools/admin_cli.py create-device-key \
  --expires 8 \
  --max-usage 1 \
  --tags diagnostic service \
  --created-by service_tech
```

---

## üõ°Ô∏è –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∏–ª—å–Ω—ã–µ –ø–∞—Ä–æ–ª–∏** –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
2. **–û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–π—Ç–µ —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è –∫–ª—é—á–µ–π** (24-48 —á–∞—Å–æ–≤)
3. **–†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ** –æ–∂–∏–¥–∞—é—â–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
4. **–û—Ç–∑—ã–≤–∞–π—Ç–µ –¥–æ—Å—Ç—É–ø** –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
5. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ª–æ–≥–∏** —Å–∏—Å—Ç–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–ø—Ä–æ–¥–∞–∫—à–µ–Ω):
```bash
export SECRET_KEY="your-production-secret-key"
export TAILSCALE_API_KEY="tskey-api-real-key"
export API_KEY="your-api-key"
export API_SECRET="your-api-secret"
```

---

## ‚úÖ –ò–¢–û–ì–û: –°–ò–°–¢–ï–ú–ê –ì–û–¢–û–í–ê!

### –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Ä–æ–ª–µ–π
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- ‚úÖ –û–¥–æ–±—Ä–µ–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–π
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–æ–º
- ‚úÖ CLI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è

### –ß—Ç–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å:
- üîÑ –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
- üîÑ –ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- üîÑ API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏! üéâ**