# üìã CHANGELOG - –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π CUBE_RS

## üöÄ v2.0.0 - Tailscale Integration (–¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è)

### ‚ú® –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- **üåê Tailscale Mesh Network** - –ø–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Tailscale –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞—â–∏—â–µ–Ω–Ω–æ–π mesh-—Å–µ—Ç–∏
- **üì± Device Registry** - —Å–∏—Å—Ç–µ–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –ø–æ –∞–Ω–∞–ª–æ–≥–∏–∏ —Å IXON Cloud
- **üë• RBAC System** - —Ä–æ–ª–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–æ–º —Å 5 –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ —Ä–æ–ª—è–º–∏
- **üé® Modern Web UI** - –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞ Bootstrap 5 —Å –¥–≤—É–º—è –æ—Å–Ω–æ–≤–Ω—ã–º–∏ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏
- **üîê Enhanced Security** - –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å HMAC –ø–æ–¥–ø–∏—Å—è–º–∏ –∏ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —Å–µ–∫—Ä–µ—Ç–∞–º–∏

### üîß –£–ª—É—á—à–µ–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
- **–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –Ω–∞ –º–æ–¥—É–ª–∏ web_app, tunnel_system, core
- **–¢—Ä–∏ SQLite –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö** –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö (–ö–£–ë-1063, —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏)
- **Async/await –ø–æ–¥–¥–µ—Ä–∂–∫–∞** –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Tailscale API
- **RESTful API** —Å –ø–æ–ª–Ω—ã–º –Ω–∞–±–æ—Ä–æ–º endpoints –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–æ–π
- **Real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è** —á–µ—Ä–µ–∑ WebSocket –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ refresh

### üóÑÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö

#### device_registry.db
```sql
-- –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
registered_devices: device_id, hostname, tailscale_ip, status, metadata, tags
-- –ö–ª—é—á–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏
auth_keys: key_id, key_hash, expires_time, usage_count, max_usage
-- –ü—Ä–æ—Ü–µ—Å—Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
device_registration_requests: request_id, device_hostname, status
```

#### rbac_system.db  
```sql
-- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
users: user_id, username, email, password_hash, roles, device_groups
-- –†–æ–ª–∏ –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
roles: role_id, name, permissions, is_system_role
-- –ì—Ä—É–ø–ø—ã —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–æ–º
device_groups: group_id, name, device_ids, device_types, tags_filter
-- –ü–æ–ª–∏—Ç–∏–∫–∏ –¥–æ—Å—Ç—É–ø–∞ —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏  
access_policies: policy_id, device_group_id, role_id, permissions, time_restrictions
```

### üåê –ù–æ–≤—ã–µ API Endpoints

#### Tailscale Management
- `GET /api/tailscale/status` - —Å—Ç–∞—Ç—É—Å mesh-—Å–µ—Ç–∏
- `GET /api/tailscale/devices` - —Å–ø–∏—Å–æ–∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- `GET /api/tailscale/farms` - —Ñ–µ—Ä–º—ã –ö–£–ë-1063
- `POST /api/tailscale/auth-key` - —Å–æ–∑–¥–∞–Ω–∏–µ –∫–ª—é—á–µ–π

#### Device Registry  
- `POST /api/registry/register` - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- `GET /api/registry/devices` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏
- `POST /api/registry/auth-key` - –∫–ª—é—á–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- `GET /api/registry/stats` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### üì± –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- **–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞** (`/`) - Dashboard –ö–£–ë-1063 —Å –≥—Ä–∞—Ñ–∏–∫–∞–º–∏ Chart.js
- **Tailscale —Å—Ç—Ä–∞–Ω–∏—Ü–∞** (`/tailscale`) - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ mesh-—Å–µ—Ç—å—é
- **Responsive design** —Å –∞–¥–∞–ø—Ç–∞—Ü–∏–µ–π –ø–æ–¥ –º–æ–±–∏–ª—å–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- **–ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞** –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª—é—á–µ–π –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏
- **Real-time –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã** —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏ API –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏

---

## üìä v1.5.0 - P2P Tunnel System

### ‚ú® –î–æ–±–∞–≤–ª–µ–Ω–æ
- P2P —Ç—É–Ω–Ω–µ–ª–∏ —á–µ—Ä–µ–∑ WebRTC –¥–ª—è –ø—Ä—è–º–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Ñ–µ—Ä–º–∞–º
- Tunnel Broker —Å–µ—Ä–≤–µ—Ä –¥–ª—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- –ú–æ–±–∏–ª—å–Ω–æ–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –∫—Ä–∞—Å–∏–≤—ã–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º
- SQLite –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ —Ñ–µ—Ä–º–∞–º–∏

### üîß –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- `tunnel_broker.py` - —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä-–∫–æ–º–º—É—Ç–∞—Ç–æ—Ä
- `farm_client.py` - –∫–ª–∏–µ–Ω—Ç —Ñ–µ—Ä–º—ã —Å heartbeat
- `mobile_app.py` - –º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- WebRTC P2P —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º

### üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
```
üì± Mobile App ‚Üê--WebRTC P2P--‚Üí üè≠ Farm Gateway
        ‚Üì                           ‚Üì
    üìû Request connection       üìû Register every 5min  
        ‚Üì                           ‚Üì
        üåê Tunnel Broker Server (–±–µ–ª—ã–π IP)
```

---

## üåü v1.0.0 - Core System

### ‚ú® –ë–∞–∑–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
- **Modbus TCP/RTU —á—Ç–µ–Ω–∏–µ** –¥–∞–Ω–Ω—ã—Ö —Å –ö–£–ë-1063
- **SQLite —Ö—Ä–∞–Ω–µ–Ω–∏–µ** –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤
- **Streamlit Dashboard** –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
- **Telegram Bot** –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- **WebSocket —Å–µ—Ä–≤–µ—Ä** –¥–ª—è real-time –¥–∞–Ω–Ω—ã—Ö

### üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –∏ —Ü–µ–ª–µ–≤–∞—è
- –í–ª–∞–∂–Ω–æ—Å—Ç—å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–∞—è  
- CO‚ÇÇ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è
- –£—Ä–æ–≤–µ–Ω—å –≤–µ–Ω—Ç–∏–ª—è—Ü–∏–∏
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã

### üîß –°–µ—Ä–≤–∏—Å—ã
- **Modbus Gateway** (–ø–æ—Ä—Ç 8000)
- **TCP Duplicator** (–ø–æ—Ä—Ç 5022) 
- **WebSocket Server** (–ø–æ—Ä—Ç 8765)
- **MQTT Publisher** –¥–ª—è IoT –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- **Dashboard** –Ω–∞ Streamlit

---

## üóÇÔ∏è –ú–∏–≥—Ä–∞—Ü–∏—è –º–µ–∂–¥—É –≤–µ—Ä—Å–∏—è–º–∏

### –ü–µ—Ä–µ—Ö–æ–¥ —Å v1.5 (P2P) –Ω–∞ v2.0 (Tailscale)

#### –ß—Ç–æ —Å–æ—Ö—Ä–∞–Ω–∏–ª–æ—Å—å:
- ‚úÖ –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã core —Å–∏—Å—Ç–µ–º—ã (Modbus, Dashboard, Telegram)
- ‚úÖ SQLite –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Å –¥–∞–Ω–Ω—ã–º–∏ –ö–£–ë-1063
- ‚úÖ API Gateway –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º
- ‚úÖ –ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–æ –ø–æ–¥ Tailscale)

#### –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:
- üîÑ WebRTC P2P ‚Üí Tailscale mesh VPN
- üîÑ Tunnel Broker ‚Üí Device Registry + Tailscale Manager
- üîÑ –ü—Ä–æ—Å—Ç–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è ‚Üí RBAC —Å–∏—Å—Ç–µ–º–∞
- üîÑ –û–¥–Ω–∞ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö ‚Üí —Ç—Ä–∏ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ

#### –ü—Ä–æ—Ü–µ—Å—Å –º–∏–≥—Ä–∞—Ü–∏–∏:
1. **–ë—ç–∫–∞–ø –¥–∞–Ω–Ω—ã—Ö**: —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ `kub_data.db` —Å –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏
2. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Tailscale**: —Å–æ–∑–¥–∞–π—Ç–µ tailnet –∏ –ø–æ–ª—É—á–∏—Ç–µ API –∫–ª—é—á  
3. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞**: `git pull` –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏
4. **–ó–∞–ø—É—Å–∫ –Ω–æ–≤—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤**: `python tools/start_all_services.py`
5. **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤**: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–æ–≤—ã–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

### –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
Legacy –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã P2P —Å–∏—Å—Ç–µ–º—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏:
- `tunnel_broker.py` - –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π P2P –±—Ä–æ–∫–µ—Ä
- `farm_client.py` - WebRTC –∫–ª–∏–µ–Ω—Ç
- `mobile_app.py` - P2P –º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

---

## üîÆ –ü–ª–∞–Ω—ã —Ä–∞–∑–≤–∏—Ç–∏—è (v2.1+)

### üõ£Ô∏è Roadmap
- **PWA –ø–æ–¥–¥–µ—Ä–∂–∫–∞** - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∫–∞–∫ –º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- **Advanced Analytics** - –ø—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω—ã–µ –º–æ–¥–µ–ª–∏ –∏ ML –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
- **Multi-tenant** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π
- **External Integrations** - API –¥–ª—è ERP/CRM —Å–∏—Å—Ç–µ–º
- **Marketplace** - —Å–∏—Å—Ç–µ–º–∞ –ø–ª–∞–≥–∏–Ω–æ–≤ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –≤–∏–¥–∂–µ—Ç–æ–≤
- **Mobile Native Apps** - –Ω–∞—Ç–∏–≤–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è iOS/Android

### üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —É–ª—É—á—à–µ–Ω–∏—è
- **Docker containerization** - —É–ø—Ä–æ—â–µ–Ω–∏–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
- **Kubernetes support** - –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –≤ production
- **PostgreSQL/TimescaleDB** - –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ SQLite –¥–ª—è –±–æ–ª—å—à–∏—Ö –Ω–∞–≥—Ä—É–∑–æ–∫
- **Redis caching** - –ø–æ–≤—ã—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- **Monitoring stack** - Prometheus/Grafana –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- **OAuth 2.0/OIDC** - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- **Hardware security keys** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ FIDO2/WebAuthn  
- **Advanced audit** - –¥–µ—Ç–∞–ª—å–Ω–æ–µ –∂—É—Ä–Ω–∞–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
- **Compliance** - —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏ –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å

- **Issues**: [GitHub Issues](https://github.com/your-repo/CUBE_RS/issues)
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: [README.md](README.md)
- **–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç**: [TAILSCALE_QUICK_START.md](TAILSCALE_QUICK_START.md)

**–í–µ—Ä—Å–∏—è**: v2.0.0  
**–î–∞—Ç–∞ —Ä–µ–ª–∏–∑–∞**: 2024-12-XX  
**–°—Ç–∞—Ç—É—Å**: Stable - –≥–æ—Ç–æ–≤–æ –∫ production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é