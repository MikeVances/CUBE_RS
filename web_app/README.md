# –ö–£–ë-1063 Web Application

–í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–∏—Å—Ç–µ–º—ã –ö–£–ë-1063 —á–µ—Ä–µ–∑ –∑–∞—â–∏—â–µ–Ω–Ω—ã–π API.

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
CUBE-1063 ‚Üí Gateway (–ª–æ–∫–∞–ª—å–Ω—ã–π) ‚Üí API Gateway ‚Üí WWW ‚Üí Web App (Render)
```

## üîß –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. **API Gateway** (`api_gateway.py`)
- –õ–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—â–∏–π –∑–∞—â–∏—â–µ–Ω–Ω—ã–π API
- HMAC –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏
- –î–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º —á–µ—Ä–µ–∑ –º–æ–¥—É–ª–∏ dashboard_reader

### 2. **Web Application** (`app.py`)
- Flask –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –Ω–∞ Render
- –ö—Ä–∞—Å–∏–≤—ã–π –¥–∞—à–±–æ—Ä–¥ —Å –≥—Ä–∞—Ñ–∏–∫–∞–º–∏ Chart.js
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

## üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ Render

### –®–∞–≥ 1: –ó–∞–ø—É—Å–∫ API Gateway –ª–æ–∫–∞–ª—å–Ω–æ

```bash
# –ó–∞–ø—É—Å–∫ API Gateway –Ω–∞ –ø–æ—Ä—Ç—É 8000
python web_app/api_gateway.py
```

API –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ `http://localhost:8000`

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ—Å—Ç—É–ø–∞ —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç

–î–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –ª–æ–∫–∞–ª—å–Ω–æ–º—É API Gateway –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:

**–í–∞—Ä–∏–∞–Ω—Ç A: ngrok**
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ ngrok –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ
ngrok http 8000
# –ü–æ–ª—É—á–∏—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π URL —Ç–∏–ø–∞ https://abc123.ngrok.io
```

**–í–∞—Ä–∏–∞–Ω—Ç B: CloudFlare Tunnel**
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ cloudflared –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ
cloudflared tunnel --url http://localhost:8000
```

### –®–∞–≥ 3: –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ Render

1. **–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π Web Service –Ω–∞ Render**
2. **–ü–æ–¥–∫–ª—é—á–∏—Ç–µ —ç—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**
3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**

```env
GATEWAY_URL=https://your-ngrok-url.ngrok.io  # URL –≤–∞—à–µ–≥–æ API Gateway
API_KEY=dev-api-key                          # API –∫–ª—é—á (—Å–º–æ—Ç—Ä–∏ –ª–æ–≥–∏ api_gateway.py)
API_SECRET=–≤–∞—à_—Å–µ–∫—Ä–µ—Ç_–∏–∑_–ª–æ–≥–æ–≤              # API —Å–µ–∫—Ä–µ—Ç –∏–∑ –ª–æ–≥–æ–≤
SECRET_KEY=—Å–ª—É—á–∞–π–Ω–∞—è_—Å—Ç—Ä–æ–∫–∞_–¥–ª—è_flask       # Flask secret key
DEBUG=false
```

4. **Build Command:** `pip install -r requirements.txt`
5. **Start Command:** `gunicorn app:app --bind 0.0.0.0:$PORT --workers 2`

### –®–∞–≥ 4: –ü–æ–ª—É—á–µ–Ω–∏–µ API –∫–ª—é—á–µ–π

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ `api_gateway.py` –≤ –ª–æ–≥–∞—Ö –ø–æ—è–≤—è—Ç—Å—è –∫–ª—é—á–∏:

```
üîë API Key: dev-api-key
üîê API Secret: 1a2b3c4d5e6f7g8h9i0j...
```

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–∏ –∫–ª—é—á–∏ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö Render.

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### API –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- **API Key**: –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞
- **HMAC Signature**: –ü–æ–¥–ø–∏—Å—å –∑–∞–ø—Ä–æ—Å–∞ —Å timestamp
- **–í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏**: –ó–∞—â–∏—Ç–∞ –æ—Ç replay-–∞—Ç–∞–∫ (5 –º–∏–Ω—É—Ç)

### –ü—Ä–∏–º–µ—Ä –ø–æ–¥–ø–∏—Å–∏ –∑–∞–ø—Ä–æ—Å–∞
```python
timestamp = str(int(time.time()))
payload = ""  # –ü—É—Å—Ç–æ–π –¥–ª—è GET –∑–∞–ø—Ä–æ—Å–æ–≤
message = f"{timestamp}{payload}"
signature = hmac.new(secret.encode(), message.encode(), hashlib.sha256).hexdigest()
```

### –ó–∞–≥–æ–ª–æ–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–∞
```
X-API-Key: dev-api-key
X-Timestamp: 1693123456
X-Signature: abcdef1234567890...
Content-Type: application/json
```

## üåê API Endpoints

### Gateway API (–ª–æ–∫–∞–ª—å–Ω—ã–π)

- `GET /api/health` - –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã
- `GET /api/data/current` - –¢–µ–∫—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ
- `GET /api/data/history?hours=6` - –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
- `GET /api/data/statistics` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã
- `GET /api/keys/info` - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± API –∫–ª—é—á–µ

### Web App API

- `GET /api/status` - –°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Gateway
- `GET /api/data/current` - –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—É—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- `GET /api/data/history` - –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- `GET /api/data/statistics` - –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

## üé® –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å

- **Responsive –¥–∏–∑–∞–π–Ω** —Å Bootstrap 5
- **–ñ–∏–≤—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏** –Ω–∞ Chart.js —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ—Å—è–º–∏
- **–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ** –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
- **–°—Ç–∞—Ç—É—Å–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã** –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- **–ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è –≤–µ—Ä—Å—Ç–∫–∞** –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤

## üêõ –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
```bash
# –õ–æ–∫–∞–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å API Gateway
curl -H "X-API-Key: dev-api-key" \
     -H "X-Timestamp: $(date +%s)" \
     -H "X-Signature: –≤–∞—à–∞_–ø–æ–¥–ø–∏—Å—å" \
     http://localhost:8000/api/health
```

### –õ–æ–≥–∏
- API Gateway: –∫–æ–Ω—Å–æ–ª—å–Ω—ã–µ –ª–æ–≥–∏
- Web App: –ª–æ–≥–∏ Render –≤ –¥–∞—à–±–æ—Ä–¥–µ

### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã
1. **API –∫–ª—é—á–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ api_gateway.py
2. **Timeout –æ—à–∏–±–∫–∏**: –£–≤–µ–ª–∏—á—å—Ç–µ API_TIMEOUT –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
3. **CORS –æ—à–∏–±–∫–∏**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ CORS –≤ api_gateway.py

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

Web –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
- **–¢–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è**: —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, –≤–ª–∞–∂–Ω–æ—Å—Ç—å, CO‚ÇÇ, –≤–µ–Ω—Ç–∏–ª—è—Ü–∏—è
- **–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –≥—Ä–∞—Ñ–∏–∫–∏**: –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 6 —á–∞—Å–æ–≤
- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫—É**: —É—Å–ø–µ—à–Ω–æ—Å—Ç—å, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–º–µ—Ä–µ–Ω–∏–π, —Å—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã
- **–°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è**: –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å–≤—è–∑–∏ —Å Gateway

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏—è

–î–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–¥–∞:
1. –û–±–Ω–æ–≤–∏—Ç–µ –∫–æ–¥ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
2. Render –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Å–æ–±–µ—Ä–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
3. API Gateway –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ