#!/usr/bin/env python3
"""
–¢–µ—Å—Ç —á—Ç–µ–Ω–∏—è –≤—Å–µ—Ö —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤ –ö–£–ë-1063 –∏–∑ Cube-1063_modbus registers.md
"""
import sys
import os
import time
sys.path.append(os.path.join(os.path.dirname(__file__), 'modbus'))
from reader import KUB1063Reader

# –í—Å–µ —Ä–µ–≥–∏—Å—Ç—Ä—ã –∏–∑ Cube-1063_modbus registers.md (Input Registers, —Ñ—É–Ω–∫—Ü–∏—è 0x04)
REGISTER_LIST = [
    (0x0301, "–í–µ—Ä—Å–∏—è –ü–û"),
    (0x0081, "–°–æ—Å—Ç. —Ü–∏—Ñ—Ä–æ–≤—ã—Ö –≤—ã—Ö–æ–¥–æ–≤ (1)"),
    (0x0082, "–°–æ—Å—Ç. —Ü–∏—Ñ—Ä–æ–≤—ã—Ö –≤—ã—Ö–æ–¥–æ–≤ (2)"),
    (0x00A2, "–°–æ—Å—Ç. —Ü–∏—Ñ—Ä–æ–≤—ã—Ö –≤—ã—Ö–æ–¥–æ–≤ (3)"),
    (0x0083, "–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ"),
    (0x0084, "–í–ª–∞–∂–Ω–æ—Å—Ç—å"),
    (0x0085, "CO2"),
    (0x0086, "NH3"),
    (0x0087, "–ì–†–í –±–∞–∑–æ–≤–æ–π –≤–µ–Ω—Ç–∏–ª—è—Ü–∏–∏"),
    (0x0088, "–ì–†–í —Ç—É–Ω–Ω–µ–ª—å–Ω–æ–π –≤–µ–Ω—Ç–∏–ª—è—Ü–∏–∏"),
    (0x0089, "–î–µ–º–ø—Ñ–µ—Ä"),
    # 0x008A‚Äì0x009B –ø—Ä–æ–ø—É—â–µ–Ω—ã (–≥—Ä—É–ø–ø–æ–≤—ã–µ)
    (0x00C3, "–ê–∫—Ç–∏–≤–Ω—ã–µ –∞–≤–∞—Ä–∏–∏"),
    (0x00C7, "–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞–≤–∞—Ä–∏–∏"),
    (0x00CB, "–ê–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è"),
    (0x00CF, "–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è"),
    (0x00D0, "–¶–µ–ª–µ–≤–æ–π —É—Ä–æ–≤–µ–Ω—å –≤–µ–Ω—Ç–∏–ª—è—Ü–∏–∏"),
    (0x00D1, "–§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –≤–µ–Ω—Ç–∏–ª—è—Ü–∏–∏"),
    (0x00D2, "–°—Ö–µ–º–∞ –≤–µ–Ω—Ç–∏–ª—è—Ü–∏–∏"),
    (0x00D3, "–°—á–µ—Ç—á–∏–∫ –¥–Ω–µ–π"),
    (0x00D4, "–¶–µ–ª–µ–≤–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞"),
    (0x00D5, "–¢–µ–∫—É—â–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞"),
    (0x00D6, "–¢–µ–º–ø. –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –≤–µ–Ω—Ç–∏–ª—è—Ü–∏–∏"),
]

def main():
    reader = KUB1063Reader()
    print("\nüîç –ß—Ç–µ–Ω–∏–µ –≤—Å–µ—Ö —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤ –ö–£–ë-1063 (Input Registers, —Ñ—É–Ω–∫—Ü–∏—è 0x04):\n")
    if not reader.connect():
        print("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤—É!")
        return
    for reg, desc in REGISTER_LIST:
        value = reader.read_register(reg, function_code=0x04)
        if value is not None:
            print(f"0x{reg:04X} ({desc}): 0x{value:04X} ({value})")
        else:
            print(f"0x{reg:04X} ({desc}): ‚ùå –Ω–µ—Ç –æ—Ç–≤–µ—Ç–∞")
        time.sleep(0.1)
    reader.disconnect()

if __name__ == "__main__":
    main() 